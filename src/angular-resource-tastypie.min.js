/*
 Angular Resource Tastypie v1.0.3
 (c) 2014-2016 Marcos William Ferretti, https://github.com/mw-ferretti/angular-resource-tastypie
 License: MIT
*/
var ngResourceTastypie={name:"Angular Resource Tastypie",description:"RESTful AngularJs client for Django-Tastypie or equivalent schema.",version:{full:"1.0.3",major:1,minor:0,dot:3,codeName:"Alpha"},author:{name:"Marcos William Ferretti",email:"ferretti.spo@gmail.com",github:"https://github.com/mw-ferretti/",linkedin:"https://www.linkedin.com/in/mwferretti"},license:"MIT, (c) 2014-2016 Marcos William Ferretti",source:"https://github.com/mw-ferretti/angular-resource-tastypie"};
if("undefined"==typeof angular)throw"[ngResourceTastypie v".concat(ngResourceTastypie.version.full,"] Requires AngularJs 1.3+");if(1>angular.version.major||1==angular.version.major&&3>angular.version.minor)throw"[ngResourceTastypie v".concat(ngResourceTastypie.version.full,"] Requires AngularJs 1.3+, your version is ",angular.version.full);function TastypieConfig(h){h.defaults.stripTrailingSlashes=!1}
function TastypieProvider(h){h.defaults.useXDomain=!0;delete h.defaults.headers.common["X-Requested-With"];h.defaults.headers.common["Content-Type"]="application/json";var l="",m="",f={username:"",api_key:""};this.setResourceUrl=function(f){l=f;var a=document.createElement("a");a.href=l;m=a.protocol.concat("//",a.hostname);""!=a.port&&(m=m.concat(":",a.port));sessionStorage&&(a=angular.fromJson(sessionStorage.userService)||{},a.url=f,sessionStorage.userService=angular.toJson(a))};this.setAuth=function(g,
a){f.username=g;f.api_key=a;h.defaults.headers.common.Authorization="ApiKey ".concat(f.username,":",f.api_key);if(sessionStorage){var e=angular.fromJson(sessionStorage.userService)||{};e.username=g;e.api_key=a;sessionStorage.userService=angular.toJson(e)}};this.close=function(){f.username="";m=l=f.api_key="";sessionStorage&&(sessionStorage.userService=angular.toJson({}))};this.getAuth=function(){return f};this.getResourceUrl=function(){return l};this.getResourceDomain=function(){return m};if(sessionStorage){var g=
angular.fromJson(sessionStorage.userService)||{};g&&g.hasOwnProperty("username")&&g.hasOwnProperty("api_key")&&g.hasOwnProperty("url")&&(this.setResourceUrl(g.url),this.setAuth(g.username,g.api_key))}var k=[];Object.defineProperties(this,{working:{get:function(){return 0<k.length},set:function(f){"undefined"==typeof f&&(f=!1);f?k.push(1):k.splice(-1,1)}}});this.$get=function(){return{resource_url:this.getResourceUrl(),resource_domain:this.getResourceDomain(),auth:this.getAuth(),working:this.working,
setAuth:this.setAuth,setResourceUrl:this.setResourceUrl,close:this.close}}}
function TastypiePaginatorFactory(h,l,m){function f(a,d,b){this.resource=a;this.filters=d||{};this.meta={};this.objects=[];this.length=this.index=0;this.range=[];k(this,b)}function g(a){var d=m.defer();"object"==typeof console&&console.log(a);d.reject({statusText:a});return d.promise}function k(a,d){if(!angular.isObject(d.meta))throw"[$tastypiePaginator] Invalid django-tastypie object.";a.meta=d.meta;for(var b=0;b<d.objects.length;b++)d.objects[b]=a.resource.objects.$create(d.objects[b]);a.objects=
d.objects;a.length=Math.ceil(d.meta.total_count/d.meta.limit);a.index=0==d.meta.offset?1:Math.ceil(d.meta.offset/d.meta.limit)+1;for(var b=[],c=1;c<=a.length;c++)b.push(c);a.range=b}function n(a,d){if(d)return a.resource.working=!0,h(d).get().$promise.then(function(c){k(a,c);a.resource.working=!1;return a},function(c){c=c||{};c.statusText="[$tastypiePaginator][$get] ".concat(c.statusText||"Server Not Responding.");a.resource.working=!1;throw c;});var b="[$tastypiePaginator][$get] ".concat("Invalid url.");
return g(b)}function a(e,d,b){if(d==e.index&&!b)return b="[$tastypiePaginator][$get] ".concat("Index ",d," has already been loaded."),g(b);if(0<d&&d<=e.length)return e.resource.working=!0,b=angular.copy(e.filters),b.offset=(d-1)*e.meta.limit,h(e.resource.endpoint,e.resource.defaults).get(b).$promise.then(function(c){if(c.meta.offset==c.meta.total_count){if(0==d-1)return k(e,c),e.resource.working=!1,e;e.resource.working=!1;return a(e,d-1,!0)}k(e,c);e.resource.working=!1;return e},function(a){a=a||
{};a.statusText="[$tastypiePaginator][$get] ".concat(a.statusText||"Server Not Responding.");e.resource.working=!1;throw a;});b="[$tastypiePaginator][$get] ".concat("Index ",d," not exist.");return g(b)}f.prototype.change=function(e){if(e)return a(this,e,!1);e="[$tastypiePaginator][change] ".concat('Parameter "index" not informed.');return g(e)};f.prototype.next=function(){if(this.meta.next)return n(this,l.resource_domain.concat(this.meta.next));var a="[$tastypiePaginator][next] ".concat("Not exist next pages.");
return g(a)};f.prototype.previous=function(){if(this.meta.previous)return n(this,l.resource_domain.concat(this.meta.previous));var a="[$tastypiePaginator][previous] ".concat("Not exist previous pages.");return g(a)};f.prototype.refresh=function(){return a(this,this.index,!0)};f.prototype.first=function(){return a(this,1,!1)};f.prototype.last=function(){return a(this,this.length,!1)};return f}
function TastypieObjectsFactory(h,l,m){function f(a){this.resource=a}function g(a){var e=m.defer();"object"==typeof console&&console.log(a);e.reject({statusText:a});return e.promise}function k(a,e){var d={post:{method:"POST"},save:{method:"POST"},get:{method:"GET",url:a.resource.endpoint.concat(":id/")},get_uri:{method:"GET",url:a.resource.endpoint.concat(":id/")},update:{method:"PATCH",url:a.resource.endpoint.concat(":id/")},put:{method:"PUT",url:a.resource.endpoint.concat(":id/")},patch:{method:"PATCH",
url:a.resource.endpoint.concat(":id/")},"delete":{method:"DELETE",url:a.resource.endpoint.concat(":id/")},remove:{method:"DELETE",url:a.resource.endpoint.concat(":id/")}},d=h(a.resource.endpoint,{id:"@id"},d);delete d.prototype.$query;d.prototype.$get=function(b){angular.extend(this,b||{});if(!this.hasOwnProperty("id"))return b="[$tastypieObjects][$get] ".concat("Attribute [id] is required."),g(b);a.resource.working=!0;return this.$get_uri(this).then(function(c){a.resource.working=!1;return c},function(c){c=
c||{};c.statusText="[$tastypieObjects][$get] ".concat(c.statusText||"Server Not Responding.");a.resource.working=!1;throw c;})};d.prototype.$save=function(b){angular.extend(this,b||{});b=this.hasOwnProperty("id")?this.$put():this.$post();a.resource.working=!0;return b.then(function(c){a.resource.working=!1;typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();return c},function(c){c=c||{};c.statusText="[$tastypieObjects][$save] ".concat(c.statusText||"Server Not Responding.");
a.resource.working=!1;throw c;})};d.prototype.$update=function(b){angular.extend(this,b||{});if(!this.hasOwnProperty("id")||!this.id)return b="[$tastypieObjects][$update] ".concat("Attribute [id] is required."),g(b);a.resource.working=!0;return this.$patch().then(function(c){a.resource.working=!1;typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();return c},function(c){c=c||{};c.statusText="[$tastypieObjects][$update] ".concat(c.statusText||"Server Not Responding.");a.resource.working=
!1;throw c;})};d.prototype.$delete=function(b){var c=this;angular.extend(c,b||{});if(!c.hasOwnProperty("id")||!c.id)return b="[$tastypieObjects][$delete] ".concat("Attribute [id] is required."),g(b);a.resource.working=!0;return c.$remove().then(function(b){a.resource.working=!1;angular.forEach(c,function(a,b){delete c[b]});typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();return b},function(b){b=b||{};b.statusText="[$tastypieObjects][$delete] ".concat(b.statusText||"Server Not Responding.");
a.resource.working=!1;throw b;})};d.prototype.$clear=function(){var a=this;angular.forEach(a,function(c,d){delete a[d]})};return new d(e)}function n(a){var e=h(a.resource.endpoint,a.resource.defaults,{get:{method:"GET"},find:{method:"GET"}});e.prototype.$find=function(d){a.resource.working=!0;return this.$get(d).then(function(b){a.resource.working=!1;a.resource.page=new l(a.resource,d,b);return a.resource.page},function(b){b=b||{};b.statusText="[$tastypieObjects][$find] ".concat(b.statusText||"Server Not Responding.");
a.resource.working=!1;throw b;})};return new e}f.prototype.$create=function(a){return k(this,a)};f.prototype.$get=function(a){return k(this).$get(a)};f.prototype.$delete=function(a){return k(this,a).$delete()};f.prototype.$find=function(a){return n(this).$find(a)};f.prototype.$update=function(a){return k(this,a).$update()};return f}
function TastypieResourceFactory(h,l,m,f){return function(g,k){if(!g)throw"[$tastypieResource] Unknown service name.";this.endpoint=l.resource_url.concat(g,"/");this.defaults=k||{};this.page={};this.objects=new f(this);var h=[];Object.defineProperties(this,{working:{get:function(){return 0<h.length},set:function(a){"undefined"==typeof a&&(a=!1);a?h.push(1):h.splice(-1,1);l.working=a}}})}}var ResourceTastypieModule=angular.module("ngResourceTastypie",["ngResource"]);
ResourceTastypieModule.constant("ngResourceTastypie",ngResourceTastypie);TastypieConfig.$inject=["$resourceProvider"];ResourceTastypieModule.config(TastypieConfig);TastypieProvider.$inject=["$httpProvider"];ResourceTastypieModule.provider("$tastypie",TastypieProvider);TastypiePaginatorFactory.$inject=["$resource","$tastypie","$q"];ResourceTastypieModule.factory("$tastypiePaginator",TastypiePaginatorFactory);TastypieObjectsFactory.$inject=["$resource","$tastypiePaginator","$q"];
ResourceTastypieModule.factory("$tastypieObjects",TastypieObjectsFactory);TastypieResourceFactory.$inject=["$resource","$tastypie","$tastypiePaginator","$tastypieObjects"];ResourceTastypieModule.factory("$tastypieResource",TastypieResourceFactory);
