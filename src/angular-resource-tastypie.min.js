/*
 Angular Resource Tastypie v1.0.0
 (c) 2014-2015 Marcos William Ferretti, https://github.com/mw-ferretti/angular-resource-tastypie
 License: MIT
*/
var ngResourceTastypie={name:"Angular Resource Tastypie",description:"RESTful AngularJs client for Django-Tastypie or equivalent schema.",version:{full:"1.0.0",major:1,minor:0,dot:0,codeName:"Alpha"},author:{name:"Marcos William Ferretti",email:"ferretti.spo@gmail.com",github:"https://github.com/mw-ferretti/",linkedin:"https://www.linkedin.com/in/mwferretti"},license:"MIT, (c) 2014-2015 Marcos William Ferretti",source:"https://github.com/mw-ferretti/angular-resource-tastypie"};
if("undefined"==typeof angular)throw"[ngResourceTastypie v".concat(ngResourceTastypie.version.full,"] Requires AngularJs 1.3+");if(1>angular.version.major||1==angular.version.major&&3>angular.version.minor)throw"[ngResourceTastypie v".concat(ngResourceTastypie.version.full,"] Requires AngularJs 1.3+, your version is ",angular.version.full);function TastypieConfig(e){e.defaults.stripTrailingSlashes=!1}
function TastypieProvider(e){e.defaults.useXDomain=!0;delete e.defaults.headers.common["X-Requested-With"];e.defaults.headers.common["Content-Type"]="application/json";var g="",k="",b={username:"",api_key:""};this.setResourceUrl=function(b){g=b;b=document.createElement("a");b.href=g;k=b.protocol.concat("//",b.hostname);""!=b.port&&(k=k.concat(":",b.port))};this.setAuth=function(f,h){b.username=f;b.api_key=h;e.defaults.headers.common.Authorization="ApiKey ".concat(b.username,":",b.api_key)};this.getAuth=
function(){return b};this.getResourceUrl=function(){return g};this.getResourceDomain=function(){return k};this.$get=function(){return{resource_url:this.getResourceUrl(),resource_domain:this.getResourceDomain(),auth:this.getAuth(),setAuth:this.setAuth,setResourceUrl:this.setResourceUrl}}}
function TastypiePaginatorFactory(e,g,k){function b(n,a,d){this.resource=n;this.filters=a||{};this.meta={};this.objects=[];this.length=this.index=0;this.range=[];h(this,d)}function f(a){var c=k.defer();"object"==typeof console&&console.log(a);c.reject({statusText:a});return c.promise}function h(a,c){if(!angular.isObject(c.meta))throw"[$tastypiePaginator] Invalid django-tastypie object.";a.meta=c.meta;for(var d=0;d<c.objects.length;d++)c.objects[d]=a.resource.objects.$create(c.objects[d]);a.objects=
c.objects;a.length=Math.ceil(c.meta.total_count/c.meta.limit);a.index=0==c.meta.offset?1:Math.ceil(c.meta.offset/c.meta.limit)+1;for(var d=[],l=1;l<=a.length;l++)d.push(l);a.range=d}function m(a,c){if(c)return e(c).get().$promise.then(function(l){h(a,l);return a},function(a){a=a||{};a.statusText="[$tastypiePaginator][$get] ".concat(a.statusText||"Server Not Responding.");throw a;});var d="[$tastypiePaginator][$get] ".concat("Invalid url.");return f(d)}function a(b,c,d){if((c!=b.index||d)&&0<c&&c<=
b.length)return d=angular.copy(b.filters),d.offset=(c-1)*b.meta.limit,e(b.resource.endpoint,b.resource.defaults).get(d).$promise.then(function(l){if(l.meta.offset==l.meta.total_count)a(b,c-1,!0);else return h(b,l),b},function(a){a=a||{};a.statusText="[$tastypiePaginator][$get] ".concat(a.statusText||"Server Not Responding.");throw a;});d="[$tastypiePaginator][$get] ".concat("Index ",c," not exist.");return f(d)}b.prototype.change=function(b){if(b)return a(this,b,!1);b="[$tastypiePaginator][change] ".concat('Parameter "index" not informed.');
return f(b)};b.prototype.next=function(){if(this.meta.next)return m(this,g.resource_domain.concat(this.meta.next));var a="[$tastypiePaginator][next] ".concat("Not exist next pages.");return f(a)};b.prototype.previous=function(){if(this.meta.previous)return m(this,g.resource_domain.concat(this.meta.previous));var a="[$tastypiePaginator][previous] ".concat("Not exist previous pages.");return f(a)};b.prototype.refresh=function(){return a(this,this.index,!0)};b.prototype.first=function(){return a(this,
1,!1)};b.prototype.last=function(){return a(this,this.length,!1)};return b}
function TastypieObjectsFactory(e,g,k){function b(a){this.resource=a}function f(a){var b=k.defer();"object"==typeof console&&console.log(a);b.reject({statusText:a});return b.promise}function h(a,b){var c={post:{method:"POST"},save:{method:"POST"},get:{method:"GET",url:a.resource.endpoint.concat(":id/")},get_uri:{method:"GET",url:a.resource.endpoint.concat(":id/")},update:{method:"PATCH",url:a.resource.endpoint.concat(":id/")},put:{method:"PUT",url:a.resource.endpoint.concat(":id/")},patch:{method:"PATCH",
url:a.resource.endpoint.concat(":id/")},"delete":{method:"DELETE",url:a.resource.endpoint.concat(":id/")},remove:{method:"DELETE",url:a.resource.endpoint.concat(":id/")}},c=e(a.resource.endpoint,{id:"@id"},c);delete c.prototype.$query;c.prototype.$get=function(a){angular.extend(this,a||{});return this.hasOwnProperty("id")?this.$get_uri().then(function(a){return a},function(a){a=a||{};a.statusText="[$tastypieObjects][$get] ".concat(a.statusText||"Server Not Responding.");throw a;}):(a="[$tastypieObjects][$get] ".concat("Attribute [id] is required."),
f(a))};c.prototype.$save=function(b){angular.extend(this,b||{});return(this.hasOwnProperty("id")?this.$put():this.$post()).then(function(b){typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();return b},function(a){a=a||{};a.statusText="[$tastypieObjects][$save] ".concat(a.statusText||"Server Not Responding.");throw a;})};c.prototype.$update=function(b){angular.extend(this,b||{});return this.hasOwnProperty("id")?this.$patch().then(function(b){typeof a.resource.page.refresh==
typeof Function&&a.resource.page.refresh();return b},function(a){a=a||{};a.statusText="[$tastypieObjects][$update] ".concat(a.statusText||"Server Not Responding.");throw a;}):(b="[$tastypieObjects][$update] ".concat("Attribute [id] is required."),f(b))};c.prototype.$delete=function(b){var c=this;angular.extend(c,b||{});return c.hasOwnProperty("id")?c.$remove().then(function(b){angular.forEach(c,function(a,b){delete c[b]});typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();
return b},function(a){a=a||{};a.statusText="[$tastypieObjects][$delete] ".concat(a.statusText||"Server Not Responding.");throw a;}):(b="[$tastypieObjects][$delete] ".concat("Attribute [id] is required."),f(b))};c.prototype.$clear=function(){var a=this;angular.forEach(a,function(b,c){delete a[c]})};return new c(b)}function m(a){var b=e(a.resource.endpoint,a.resource.defaults,{get:{method:"GET"},find:{method:"GET"}});b.prototype.$find=function(b){return this.$get(b).then(function(d){a.resource.page=
new g(a.resource,b,d);return a.resource.page},function(a){a=a||{};a.statusText="[$tastypieObjects][$find] ".concat(a.statusText||"Server Not Responding.");throw a;})};return new b}b.prototype.$create=function(a){return h(this,a)};b.prototype.$get=function(a){return h(this,a).$get()};b.prototype.$delete=function(a){return h(this,a).$delete()};b.prototype.$find=function(a){return m(this).$find(a)};b.prototype.$update=function(a){return h(this,a).$update()};return b}
function TastypieResourceFactory(e,g,k,b){return function(f,e){if(!f)throw"[$tastypieResource] Unknown service name.";this.endpoint=g.resource_url.concat(f,"/");this.defaults=e||{};this.page={};this.objects=new b(this)}}var ResourceTastypieModule=angular.module("ngResourceTastypie",["ngResource"]);ResourceTastypieModule.constant("ngResourceTastypie",ngResourceTastypie);TastypieConfig.$inject=["$resourceProvider"];ResourceTastypieModule.config(TastypieConfig);TastypieProvider.$inject=["$httpProvider"];
ResourceTastypieModule.provider("$tastypie",TastypieProvider);TastypiePaginatorFactory.$inject=["$resource","$tastypie","$q"];ResourceTastypieModule.factory("$tastypiePaginator",TastypiePaginatorFactory);TastypieObjectsFactory.$inject=["$resource","$tastypiePaginator","$q"];ResourceTastypieModule.factory("$tastypieObjects",TastypieObjectsFactory);TastypieResourceFactory.$inject=["$resource","$tastypie","$tastypiePaginator","$tastypieObjects"];ResourceTastypieModule.factory("$tastypieResource",TastypieResourceFactory);
